{
  "chapter_id": "cli-reference",
  "chapter_title": "CLI Reference",
  "chapter_file": "book/src/cli-reference.md",
  "drift_detected": true,
  "severity": "medium",
  "quality_assessment": "The CLI Reference is generally accurate and comprehensive, but has some minor inconsistencies with the actual CLI implementation. Most options are correctly documented, but there are small discrepancies in option availability across commands and some missing validation command options.",
  "issues": [
    {
      "type": "missing_content",
      "severity": "medium",
      "section": "validate command options",
      "description": "The validate command in the code has several analysis-related options that aren't explicitly listed in the CLI Reference",
      "should_add": "Document that validate command supports threshold_complexity, threshold_duplication, threshold_preset, languages, and other analysis control options",
      "fix_suggestion": "Update the validate command section to explicitly list all analysis control options it accepts (from line 218-282 in src/cli.rs). The compatibility matrix at line 580 shows these as supported, but the validate command description doesn't detail them.",
      "source_reference": "src/cli.rs:218-282"
    },
    {
      "type": "missing_content",
      "severity": "low",
      "section": "validate command options",
      "description": "Validate command supports group_by_category, filter_categories, min_priority, plain, no_parallel, jobs, and caching options",
      "should_add": "Add these options to the validate command documentation: --group-by-category, --filter, --min-priority, --plain, --no-parallel, -j/--jobs, --no-cache, --clear-cache, --cache-location",
      "fix_suggestion": "Expand the validate command section to list all display, performance, and caching options it supports. Currently the docs only mention a subset.",
      "source_reference": "src/cli.rs:218-282"
    },
    {
      "type": "incomplete_explanation",
      "severity": "low",
      "section": "validate command",
      "description": "The validate command section says 'All analysis, coverage, context, display, and verbosity options from analyze command' but doesn't clarify which specific options",
      "current_content": "- All analysis, coverage, context, display, and verbosity options from `analyze` command",
      "should_be": "List specific options or reference the analyze command sections: threshold-complexity, threshold-duplication, threshold-preset, languages, top, tail, summary, semantic-off, verbosity, group-by-category, min-priority, filter, plain, jobs, no-parallel, cache options",
      "fix_suggestion": "Either list all supported options explicitly in the validate section, or add clear references like 'See Analysis Control, Display Filtering, Performance & Caching, and Debugging sections for additional options supported by validate'",
      "source_reference": "src/cli.rs:218-282"
    },
    {
      "type": "outdated_information",
      "severity": "low",
      "section": "Option Aliases",
      "description": "Documentation shows --use-cache as deprecated, but the code uses 'cache' not 'use_cache' as the flag name",
      "current_content": "- `--use-cache` (hidden) - **Deprecated:** caching is now enabled by default",
      "should_be": "- `--cache` (hidden) - **Deprecated:** caching is now enabled by default",
      "fix_suggestion": "Change --use-cache to --cache in the deprecated options section to match the actual flag name in src/cli.rs:142",
      "source_reference": "src/cli.rs:142"
    },
    {
      "type": "missing_content",
      "severity": "low",
      "section": "Commands",
      "description": "The compare command documentation doesn't mention that --plan and --target-location conflict with each other",
      "should_add": "Note that --plan and --target-location are mutually exclusive options",
      "fix_suggestion": "Add a note in the compare command section: 'Note: --plan and --target-location cannot be used together; use one or the other to specify the target location.'",
      "source_reference": "src/cli.rs:300"
    },
    {
      "type": "unclear_content",
      "severity": "low",
      "section": "Command Compatibility Matrix",
      "description": "The compatibility matrix shows checkmarks but doesn't clearly indicate partial support for validate command options",
      "current_content": "Matrix shows checkmarks for various options across commands",
      "should_be": "Matrix should clarify that validate supports most analyze options (threshold-*, --top/--tail, --cache-*, --jobs, --verbose) even though they're not explicitly listed in its description",
      "fix_suggestion": "Add a note below the compatibility matrix: 'Note: The validate command supports most analysis control, display filtering, performance, and debugging options from the analyze command. See the analyze command documentation for details on these options.'",
      "source_reference": "src/cli.rs:218-282"
    },
    {
      "type": "missing_content",
      "severity": "low",
      "section": "Analysis Control",
      "description": "Missing detail about threshold-complexity and threshold-duplication being available in validate command",
      "should_add": "Clarify that threshold options work in both analyze and validate commands",
      "fix_suggestion": "Add a note in the Thresholds subsection: 'These threshold options are available in both analyze and validate commands, with validate using them in addition to config file thresholds.'",
      "source_reference": "src/cli.rs:218-282"
    }
  ],
  "positive_aspects": [
    "Comprehensive documentation of all major commands (analyze, init, validate, compare)",
    "Well-organized sections with clear categories (Output Control, Analysis Control, etc.)",
    "Excellent examples section with practical use cases",
    "Good troubleshooting section with common issues and solutions",
    "Detailed workflow examples for different scenarios",
    "Accurate documentation of most CLI flags and their behavior",
    "Command compatibility matrix is a helpful reference",
    "Deprecated options are properly marked and migration paths provided",
    "Environment variables section is accurate",
    "Option aliases are clearly documented"
  ],
  "improvement_suggestions": [
    "Expand the validate command section to explicitly list all supported options rather than referencing 'all options from analyze'",
    "Add a clearer note about which analyze options are also available in validate",
    "Include more examples of the validate command with various option combinations",
    "Add a section on combining options (e.g., using --context with --coverage-file)",
    "Consider adding a 'Quick Reference' table at the top showing command syntax at a glance",
    "Add examples showing how to use --detail-level with different values",
    "Include more information about what each aggregation-method option does",
    "Add examples showing the difference between --output-format legacy vs unified"
  ],
  "metadata": {
    "analyzed_at": "2025-10-13",
    "feature_inventory": "Direct code analysis from src/cli.rs",
    "topics_covered": ["Commands", "Arguments", "Options", "Configuration"],
    "validation_focus": "Verify all CLI commands from src/cli/ are documented with current options"
  }
}
